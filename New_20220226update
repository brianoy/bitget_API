function bitget_all_data(apikey,secretkey,passphrase,start,end,detail = []) {
 //var apikey = SpreadsheetApp.getActive().getSheetByName('bitget設定').getRange('B2').getValue();
 //var secretkey = SpreadsheetApp.getActive().getSheetByName('bitget設定').getRange('B3').getValue();
 //var passphrase = SpreadsheetApp.getActive().getSheetByName('bitget設定').getRange('B4').getValue();
 //var start = 1641916800000
 //var end = 1648310400000
 var counter = 100
 var method = 'GET'
 var requestPath = "/api/mix/v1/order/fills"
 var url = "https://api.bitget.com"
 var midtradeId = ""
 detail.push([
              "Unix時間(GMT+0)",
              "開/關倉 做多/空",
              "交易對",
              "價格",
              "數量",
              "手續費",
              "tradeId",
              "利潤(未包含手續)"
            ]);

while(counter != 0){
   counter = 0
   var date = new Date();
   var time = Math.floor((date.getTime())).toString();
   var queryString = "symbol=BTCUSDT_UMCBL&startTime=" + start +"&endTime=" + end + "&lastEndId=" + midtradeId//注意時間是毫秒
   var unsign = (time + method + requestPath + "?" + queryString);
   Logger.log("URL:" + unsign)
   var signed_sha256 = Utilities.computeHmacSha256Signature(unsign,secretkey);
   var blob = Utilities.newBlob(signed_sha256);
   var signed_sha256_base64 = Utilities.base64Encode(blob.getBytes());
   var options = {
     'headers': {
      'ACCESS-KEY' : apikey,
      'ACCESS-SIGN' : signed_sha256_base64,
      'ACCESS-TIMESTAMP' : time,
      'ACCESS-PASSPHRASE' : passphrase,
      'Content-Type' : 'application/json',
      'locale' : 'zh-CN'
     }
   };
   data = UrlFetchApp.fetch(url + requestPath + "?" +queryString ,options);
   Logger.log(data);
   var json = JSON.parse(data);
   for(var nData in json.data){
            detail.push([
              json.data[nData].cTime,
              json.data[nData].side,
              json.data[nData].symbol,
              json.data[nData].price,
              json.data[nData].sizeQty,
              json.data[nData].fee,
              json.data[nData].tradeId,
              json.data[nData].profit
            ]);
          counter++
     }
   Logger.log(counter);
   Logger.log(json.data[nData].tradeId);
   if (counter == 100){
    midtradeId = json.data[nData].tradeId
    continue;
     }
   else{
    break;
     }
  }
  return detail
}

